"use strict";function BaseModelObserver(){var e=function(e){e=e||null;var t,n,r,o=function(e){return"undefined"==typeof e},i=function(e){return"function"!=typeof e},a=function(e,t){if(i(e))throw new Error('"signature" parameter should be of type "function"');if(i(t))throw new Error('"implementation" parameter should be of type "function"');return e.length!==t.length};switch(!0){case null===e:throw new Error("No arguments supplied to an instance of Interface constructor.");case o(e.type):throw new Error("Interface.type not defined.");case o(e.implementation):throw new Error("The interface ".concat(e.type).concat(" has not been implemented."))}t=e.type,n=e.implementation,r={};for(var u in e){var c=e[u];i(c)||(r[u]=c)}for(var c in r){if(o(n[c]))throw new Error(t.concat(".").concat(c).concat(" has not been implemented."));for(var u in n){var l=n[u];switch(!0){case o(r[u]):throw new Error(u.concat(" is not a defined member of ").concat(t).concat("."));case i(l):throw new Error(t.concat(".").concat(u).concat(" has not been implemented as a function."));case a(r[u],l):throw new Error("An implementation of ".concat(t).concat(".").concat(u).concat(" does not have the correct number of arguments."));default:r[u]=l}}}return r},t={interfaces:{},create:function(e,t){this.interfaces[e]=t},implement:function(t,n){return this.interfaces[t].implementation=n,this.interfaces[t].type=t,new e(this.interfaces[t])}},n=n||{};return n.handlerApi=function(){var e="handlers",n={},r={};return t.create(e,{initter:function(e,t,n,r,o){return e},getter:function(e,t){return e},setter:function(e,t,n){return e}}),this.define=function(o){var i=t.implement(e,o);for(var a in o)o.hasOwnProperty(a)&&(n.hasOwnProperty(a)||(n[a]=[]),Object.defineProperty(r,a,{get:function(){return n[a]},set:function(e){n[a].push(e)},enumerable:!0,configurable:!0}),r[a]=i[a])},this.runHandler=function(e){for(var t in n[e])n[e].hasOwnProperty(t)&&(arguments[1][0]=n[e][t].apply(this,arguments[1]));return arguments[1][0]},this},n.handler=new n.handlerApi,n.createModel=function(e,t,r,o){var o=o||"root",i={};i[o]=e;var a=n.rec(i,t,r);return a[o]},n.rec=function(e,t,r){var t=t||[];for(var o in e)t.push(o),n.define(e[o],e,o,t.slice(),r),"object"==typeof e[o]&&n.rec(e[o],t,e),t.pop();return e},n.define=function(e,t,r,o,i){e=n.handler.runHandler("initter",[e,t,r,o,i]),Object.defineProperty(t,r,{configurable:!0,get:function(){return n.handler.runHandler.bind(this)("getter",[e,o])},set:function(t){e=n.handler.runHandler.bind(this)("setter",[t,e,o])}})},n}function ModelFormHandlers(e,t){function n(e){return e&&"Array"==e.constructor.name}function r(e,t){for(var n in e)if(e[n]==t)return!0;return!1}function o(e){return void 0===e||null===e||"boolean"==typeof e||""===String(e).trim()?!1:String(parseInt(e))===String(e)}function i(e){if(void 0===e||null===e||"boolean"==typeof e||""===String(e).trim())return!1;var t=String(e),n=t.split(".");if(t.indexOf(".")>-1&&2==n.length){var r=String(parseFloat(t).toFixed(n[1].length));return""!=n[0]&&r==t||""==n[0]&&r.replace("0.",".")==t}return!1}function a(e,t){return"integer"==t.attr("data-type")&&o(e)?parseInt(e):"number"==t.attr("data-type")&&i(e)?parseFloat(e):e}var t=t||"data-bind",u=u||{};return u.selector=function(e){return"["+t+'="'+e.join(".")+'"]'},u.initter=function(e,t,o,i){i.length&&void 0!==i.prop("value")&&i.change(function(n){i.hasClass("select2")?u.callback():e[t]=e[t].value}),n(o)&&i.length?"select-multiple"==i[0].type?i.val(o):$.each(i,function(e,t){this.checked=r(o,t.value)}):i.length&&("checkbox"==i[0].type?i[0].checked=Boolean(o):"radio"==i[0].type?$.each(i,function(e,t){this.checked=o==t.value}):"select"==i[0].type||"select-one"==i[0].type?i[0].selected=o==i.val():void 0!==i.prop("value")?i.val(o):i.text(o))},u.setter=function(e,t){t.length>1?$.each(t,function(n,o){"radio"==o.type?t[n].checked=o.value==e:"checkbox"==o.type?r(e,o.value)?$(this).prop("checked","checked"):$(this).removeAttr("checked"):void 0!==$(this).prop("value")?$(this).val(e):$(this).text(e)}):t.length&&("checkbox"==t[0].type?t[0].checked=Boolean(e):t.hasClass("select2")?t.val(e).trigger("change"):void 0!==t.prop("value")?t.val(e):t.text(e))},u.getter=function(e,t){if(t.length&&t[0].multiple){if("select-multiple"==t[0].type)return t.val()?t.val().map(function(e){return a(e,t)}):[];if("checkbox"==t[0].type)return t.filter(function(){return this.checked}).map(function(){return a($(this).attr("value"),t)}).get()}else{if(t.length&&"radio"==t[0].type)return a($(t).filter(function(){return this.checked}).val(),t);if(t.length)return"checkbox"==t[0].type?t[0].checked:void 0!==t.prop("value")?a(t.val(),t):a(t.text(),t)}},u.callback=function(){},u.handler={initter:function(e,t,n,r,o){return u.initter(t,n,e.value,$(u.selector(r))),e},getter:function(e,t){return e.value=u.getter(e.value,$(u.selector(t))),e},setter:function(e,t,n){return u.setter(e.value,$(u.selector(n))),u.callback(),e}},{formHandler:u.handler}}function ModelObserverHandlers(e){function t(e){return e&&"Array"==e.constructor.name}function n(e){return"undefined"==typeof e||1==e?(new Date).toISOString():Date.now()}function r(e,t){for(var n in t)"object"!=typeof e[n]?e[n]=t[n]:"object"==typeof t[n]&&(e[n]=r(e[n],t[n]));return e}function o(e,t,n,o,i){var a=e[t],n=r({enumerable:!1,configurable:!0},n||{});n.get=o||function(){return a},n.set=i||function(e){a=e},Object.defineProperty(e,t,n)}function i(e){var t=e.value,r={enumerable:!1,configurable:!0};r.get=function(){return this.canget?t:void 0},r.set=function(e){this.canset&&(t=e,this.updated=n())},Object.defineProperty(e,"value",r)}function a(t){var r=(t.value,{enumerable:!1,configurable:!0});r.get=function(){var e={};if(this.canget)for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t].value);return e},r.set=function(t){if(this.canset){var r=this.path.slice();for(var o in t){if(r.push(o),this.hasOwnProperty(o))this[o].value=t[o],this[o].updated=n();else{if("object"==typeof t[o]){e.createModel(t[o],r.slice(0,-1),this,o);this[o]=t[o],this[o].parent=this}else e.define(t[o],this,o,r.slice(),this);this.updated=n()}r.pop()}}},Object.defineProperty(t,"value",r)}function u(e,t,n){var r=e[t]=n||!0,i=function(){return r},a=function(e){r=e;for(var n in this)this[n].hasOwnProperty(t)&&(this[n][t]=r)};o(e,t,{configurable:!0},i,a)}function c(e,t,n){Object.defineProperty(e,t,{value:e[t]||n,enumerable:!1,configurable:!1,writable:!1})}function l(e,t,n){var r=e[t]=n,i=function(){return r},a=function(e){r=e,this.parent&&(this.parent[t]=e)};o(e,t,{enumerable:!1,configurable:!0},i,a)}function f(e){var t=function(){return this.parent?[this.key].concat(this.parent.path.reverse()).reverse():[this.key]};o(e,"path",{configurable:!0},t)}function s(e,t){e[t].push=function(e){var n={};n[this.parent[t].length]=e,this.parent[t]=n},o(e[t],"push")}function h(e,t){e[t].unshift=function(e){var r=this.parent[t],o=r.length;r.push({}),r[o]=r[o-1],r[o].key=o,r[o].updated=n();do o-=1,delete r[o],r[o]=r[o-1],r[o].key=o,r[o].updated=n();while(o>1);delete r[0],this.parent[t]={0:e}},o(e[t],"unshift")}function p(e,t){e[t].pop=function(){this.parent[t].remove(-1)},o(e[t],"pop")}function d(e,t){e[t].shift=function(){this.parent[t].remove(0)},o(e[t],"shift")}function v(e,t){e[t].remove=function(e,r){var o=this.parent[t],i=o.length-1;if(void 0==e){for(var a in o)a=parseInt(a),delete o[a];o.splice(0,i+1)}else if(0>e&&(e=e+i+1),e>-1&&i+1>e){(void 0==r||2>r)&&(r=1);for(var a in o)a>=e&&(a=parseInt(a),delete o[a],i>a&&(o[a]=o[a+1],o[a].key=a,o[a].updated=n()));o.splice(i,1),r-=1,r>0&&o.remove(e,r)}o.updated=n(),this.parent[t]={}},o(e[t],"remove")}Date.now||(Date.now=function(){return(new Date).getTime()});var m={initter:function(e,r,m,g,y){null!==e&&"object"==typeof e?(r[m].value=e,a(r[m]),r[m].branch=!0,o(r[m],"branch"),t(e)&&(s(r,m),v(r,m),p(r,m),d(r,m),h(r,m))):(r[m]={value:e},i(r[m]),r[m].node=!0,o(r[m],"node")),r[m].key=m,o(r[m],"key");var b,w,k={enumerable:!1,configurable:!0};return b=g.length>1?g[g.length-2]:null,b&&(w=y[b]),r[m].parent=w,o(r[m],"parent",k),r[m].path=g,f(r[m],"path"),r[m].old_value=e,o(r[m],"old_value",k),u(r[m],"canget",r[m].canget),u(r[m],"canset",r[m].canset),c(r[m],"created",r[m].created||n()),l(r[m],"updated",r[m].updated),(null===e||"object"!=typeof e)&&(e=r[m]),e},getter:function(e,t){return e},setter:function(e,t,n){return t.old_value=t.value,t.value=e,t}};return{valueHandler:m}}"undefined"!=typeof module&&("undefined"==typeof module.exports&&(module.exports={}),exports.BaseModelObserver=BaseModelObserver),"undefined"!=typeof module&&("undefined"==typeof module.exports&&(module.exports={}),exports.ModelFormHandlers=ModelFormHandlers),"undefined"!=typeof module&&("undefined"==typeof module.exports&&(module.exports={}),module.exports.ModelObserverHandlers=ModelObserverHandlers);